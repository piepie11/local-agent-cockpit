# 测试报告（全量回归 + 启动/健康检查）

## 测试环境
- OS：Windows（PowerShell）
- Node：v22.16.0
- Codex CLI：codex-cli 0.77.0
- Claude Code：2.0.67

## 执行的测试
### 1) 全量回归
- 命令：`npm run m3:deep`
- 结果：PASS
- 覆盖：
  - M0：`m0:smoke` / `m0:roundtrip`
  - M1：`m1:e2e:fake` / `m1:e2e:codex` / `m1:e2e:claude`
  - M2：`m2:api:e2e`
  - M3：`m3:capabilities` / `m3:e2e:codex:resume` / `m3:e2e:claude:resume` / `m3:e2e:mixed:resume` / `m3:e2e:rollover`
- 本次产物目录（runs/）：
  - `runs/smoke-20251225_023319`
  - `runs/roundtrip-20251225_023326`
  - `runs/e2e-fake-20251225_023444`
  - `runs/e2e-codex-20251225_023446`
  - `runs/e2e-claude-20251225_023533`
  - `runs/api-e2e-20251225_023614`
  - `runs/capabilities-20251225_023627`
  - `runs/e2e-codex-resume-20251225_023631`
  - `runs/e2e-claude-resume-20251225_023749`
  - `runs/e2e-mixed-resume-20251225_023936`
  - `runs/rollover-e2e-20251225_024026`

### 2) 启动与健康检查
- `node scripts/up.js --help`：usage 输出正常
- 直接启动服务后请求健康检查：
  - `GET /api/health` → 200
  - 响应包含 `ok/name/adminTokenSource/allowedWorkspaceRoots/maxConcurrentRuns/readOnlyMode`

## 观察与已知项
- SQLite：Node v22 会提示 `ExperimentalWarning`（已知现象，不影响测试通过）
- Windows：`scripts/lib/run_codex_exec.js` 在未命中可执行文件时会回退 `shell:true`（smoke/roundtrip 中可见 `usedShell: true`；属于兼容性策略的一部分）

## 结论
- 全量回归与基础启动链路均通过，满足当前 `plan.md` / `约定.md` 的验收口径。

