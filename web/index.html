<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>local-agent-cockpit</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="topbar__left">
        <div class="topbar__title">local-agent-cockpit</div>
        <select id="workspaceSelect" class="select" title="宸ヤ綔鍖? data-i18n-title="top.workspace_select_title"></select>
        <button
          id="addWorkspaceBtn"
          class="btn btn--ghost"
          title="娣诲姞宸ヤ綔鍖?
          data-i18n="top.add"
          data-i18n-title="top.add_workspace_title"
        >
          鏂板
        </button>
        <button id="openAskBtn" class="btn btn--ghost" title="Codex 鐢ㄦ埛绐楀彛" data-i18n="top.ask" data-i18n-title="top.ask_title">
          Codex 鐢ㄦ埛绐楀彛
        </button>
      </div>
      <div class="topbar__right">
        <button id="langToggleBtn" class="btn btn--ghost" title="鍒囨崲璇█" data-i18n="top.lang_toggle" data-i18n-title="top.lang_toggle_title">
          EN
        </button>
        <label class="token">
          <span data-i18n="top.admin_token_label">鍙ｄ护锛圓DMIN_TOKEN锛?/span>
          <input
            id="adminToken"
            type="password"
            placeholder="鍐欐搷浣滃繀濉?
            data-i18n-placeholder="top.admin_token_placeholder"
            autocomplete="off"
          />
        </label>
      </div>
    </header>

    <main class="container">
      <nav class="nav">
        <button class="nav__btn" data-page="dashboard" data-i18n="nav.dashboard">鎺у埗鍙?/button>
        <button class="nav__btn" data-page="history" data-i18n="nav.history">鍘嗗彶</button>
        <button class="nav__btn" data-page="sessions" data-i18n="nav.sessions">浼氳瘽</button>
        <button class="nav__btn" data-page="ask" data-i18n="nav.ask">Codex 鐢ㄦ埛绐楀彛</button>
        <button class="nav__btn" data-page="files" data-i18n="nav.files">鏂囦欢</button>
        <button class="nav__btn" data-page="settings" data-i18n="nav.settings">璁剧疆</button>
      </nav>

      <section id="page-dashboard" class="page card">
        <div id="onboardingEmptyWorkspace" class="onboarding hidden">
          <div class="onboarding__header">
            <div>
              <div class="onboarding__title" data-i18n="onboarding.title">鏂版墜寮曞锛氬厛璺戦€氭渶灏忛棴鐜?/div>
              <div class="onboarding__subtitle" data-i18n="onboarding.subtitle">鎸?3 姝ヨ蛋閫氾細璁剧疆 token 鈫?鏂板缓 workspace 鈫?Start/Step</div>
            </div>
            <button id="onboardingDismissBtn" class="btn btn--ghost" data-i18n="onboarding.dismiss">涓嶅啀鎻愮ず</button>
          </div>
          <ol class="onboarding__steps">
            <li data-i18n="onboarding.step1">Step 1锛氳缃?ADMIN_TOKEN锛堝彸涓婅锛?/li>
            <li data-i18n="onboarding.step2">Step 2锛氱偣鍑烩€滄柊澧炩€濆垱寤?workspace锛坮ootPath / planPath锛?/li>
            <li data-i18n="onboarding.step3">Step 3锛歀oad plan 鍚?Start/Step锛堟垨鎵撳紑 Codex 鐢ㄦ埛绐楀彛鍙戦€佷竴鏉℃秷鎭級</li>
          </ol>
          <div class="onboarding__note" data-i18n="onboarding.ask_note">鎻愮ず锛欳odex 鐢ㄦ埛绐楀彛 = 鐢ㄦ埛鐩存帴瀵硅瘽绐楀彛锛坧rovider 鐩磋亰锛?/div>
        </div>

        <div class="grid2">
          <div>
            <h2 data-i18n="dash.workspace">宸ヤ綔鍖?/h2>
            <div class="kv">
              <div class="kv__k" data-i18n="dash.kv.name">鍚嶇О</div>
              <div id="wsName" class="kv__v">-</div>
              <div class="kv__k" data-i18n="dash.kv.root">鏍圭洰褰?/div>
              <div id="wsRoot" class="kv__v mono">-</div>
              <div class="kv__k" data-i18n="dash.kv.plan">璁″垝</div>
              <div id="wsPlan" class="kv__v mono">-</div>
              <div class="kv__k" data-i18n="dash.kv.convention">绾﹀畾</div>
              <div id="wsConvention" class="kv__v mono">-</div>
            </div>
            <div class="row">
              <button id="loadPlanBtn" class="btn btn--ghost" data-i18n="dash.load_plan">鍔犺浇璁″垝</button>
              <button id="loadConventionBtn" class="btn btn--ghost" data-i18n="dash.load_convention">鍔犺浇绾﹀畾</button>
              <button id="loadDigestBtn" class="btn btn--ghost" data-i18n="dash.load_digest">鍔犺浇 repoDigest</button>
              <button id="editWorkspaceBtn" class="btn btn--ghost" data-i18n="dash.edit_workspace">缂栬緫</button>
            </div>
          </div>

          <div>
            <h2 data-i18n="dash.sessions">浼氳瘽</h2>
            <div class="row">
              <label class="field">
                <span data-i18n="role.manager">涓荤</span>
                <select id="managerSessionSelect" class="select"></select>
              </label>
              <label class="field">
                <span data-i18n="role.executor">鎵ц鑰?/span>
                <select id="executorSessionSelect" class="select"></select>
              </label>
            </div>
            <div class="row">
              <button id="createDefaultSessionsBtn" class="btn" data-i18n="dash.create_default_sessions">鍒涘缓榛樿浼氳瘽</button>
            </div>
            <div class="grid2">
              <div>
                <div class="hint" data-i18n="dash.selected_manager_session">宸查€変富绠′細璇濓紙灞炴€э級</div>
                <div id="managerSessionInfo" class="sessionInfo">(鏃?</div>
                <details class="details">
                  <summary data-i18n="dash.session_info_raw_config">鍘熷閰嶇疆锛圝SON锛?/summary>
                  <pre id="managerSessionInfoRaw" class="pre mono">(鏃?</pre>
                </details>
              </div>
              <div>
                <div class="hint" data-i18n="dash.selected_executor_session">宸查€夋墽琛岃€呬細璇濓紙灞炴€э級</div>
                <div id="executorSessionInfo" class="sessionInfo">(鏃?</div>
                <details class="details">
                  <summary data-i18n="dash.session_info_raw_config">鍘熷閰嶇疆锛圝SON锛?/summary>
                  <pre id="executorSessionInfoRaw" class="pre mono">(鏃?</pre>
                </details>
              </div>
            </div>
          </div>
        </div>

        <hr class="sep" />

        <div class="grid2">
          <div>
            <h2 data-i18n="dash.run">杩愯</h2>
            <div class="row">
              <select id="runSelect" class="select"></select>
              <button id="createRunBtn" class="btn" data-i18n="dash.create_run">鍒涘缓杩愯</button>
            </div>
            <div class="row">
              <label class="field field--inline">
                <span data-i18n="run.maxTurns">鏈€澶у洖鍚?/span>
                <input id="optMaxTurns" class="input input--sm" type="number" value="1000" min="1" />
              </label>
              <label class="field field--inline">
                <span data-i18n="run.timeoutMin">瓒呮椂锛堝垎閽燂級</span>
                <input id="optTimeoutMin" class="input input--sm" type="number" value="200" min="1" />
              </label>
              <label class="check">
                <input id="optRepoDigest" type="checkbox" checked />
                <span data-i18n="run.repoDigest">repoDigest</span>
              </label>
              <label class="check">
                <input id="optRequireGitClean" type="checkbox" />
                <span data-i18n="run.requireGitClean">瑕佹眰 git 骞插噣</span>
              </label>
              <label class="check">
                <input id="optDangerousGuard" type="checkbox" />
                <span data-i18n="run.cmdGuard">鍗遍櫓鍛戒护闃叉姢</span>
              </label>
              <label class="field field--inline">
                <span data-i18n="run.noProgressLimit">鏃犺繘灞曚笂闄?/span>
                <input id="optNoProgressLimit" class="input input--sm" type="number" value="20" min="0" />
              </label>
            </div>
            <div class="row">
              <button id="startRunBtn" class="btn" data-i18n="dash.start">寮€濮?/button>
              <button id="stepRunBtn" class="btn btn--accent" data-i18n="dash.step">鍗曟</button>
              <button id="pauseRunBtn" class="btn btn--ghost" data-i18n="dash.pause">鏆傚仠</button>
              <button id="stopRunBtn" class="btn btn--danger" data-i18n="dash.stop">鍋滄</button>
            </div>
            <div class="kv">
              <div class="kv__k" data-i18n="dash.kv.status">鐘舵€?/div>
              <div id="runStatus" class="kv__v">-</div>
              <div class="kv__k" data-i18n="dash.kv.turn">鍥炲悎</div>
              <div id="runTurn" class="kv__v">-</div>
              <div class="kv__k" data-i18n="dash.kv.sse">鎺ㄩ€?/div>
              <div id="sseStatus" class="kv__v">-</div>
            </div>
          </div>

          <div>
            <h2 data-i18n="dash.inject_export">鎻掕瘽 / 瀵煎嚭</h2>
            <div class="row">
              <select id="injectTarget" class="select">
                <option value="manager" data-i18n="role.manager_opt">涓荤锛坢anager锛?/option>
                <option value="executor" data-i18n="role.executor_opt">鎵ц鑰咃紙executor锛?/option>
              </select>
              <input id="injectMessage" class="input" placeholder="娑堟伅鈥? data-i18n-placeholder="dash.inject_placeholder" />
              <button id="injectSendBtn" class="btn" data-i18n="dash.send">鍙戦€?/button>
            </div>
            <div class="row">
              <button id="exportMdBtn" class="btn btn--ghost" data-i18n="dash.export_md">瀵煎嚭 .md</button>
              <button id="exportJsonBtn" class="btn btn--ghost" data-i18n="dash.export_json">瀵煎嚭 .json</button>
              <button id="exportJsonlBtn" class="btn btn--ghost" data-i18n="dash.export_jsonl">瀵煎嚭 .jsonl</button>
            </div>
            <div class="row">
              <input
                id="rolloverReason"
                class="input"
                placeholder="鎹㈣鍘熷洜锛堝彲閫夛級鈥?
                data-i18n-placeholder="dash.rollover_reason_placeholder"
              />
              <button id="rolloverManagerBtn" class="btn btn--ghost" data-i18n="dash.rollover_manager">涓荤鎹㈣</button>
              <button id="rolloverExecutorBtn" class="btn btn--ghost" data-i18n="dash.rollover_executor">鎵ц鑰呮崲琛€</button>
            </div>
          </div>
        </div>

        <hr class="sep" />

        <div class="tabs">
          <button class="tabs__btn" data-tab="manager" data-i18n="tab.manager">涓荤</button>
          <button class="tabs__btn" data-tab="executor" data-i18n="tab.executor">鎵ц鑰?/button>
          <button class="tabs__btn" data-tab="events" data-i18n="tab.events">浜嬩欢</button>
          <button class="tabs__btn" data-tab="plan" data-i18n="tab.plan">璁″垝</button>
          <button class="tabs__btn" data-tab="digest" data-i18n="tab.digest">repoDigest</button>
        </div>

        <div id="tab-manager" class="tab">
          <pre id="managerFeed" class="pre">(鏃犳暟鎹?</pre>
        </div>
        <div id="tab-executor" class="tab hidden">
          <pre id="executorFeed" class="pre">(鏃犳暟鎹?</pre>
        </div>
        <div id="tab-events" class="tab hidden">
          <pre id="eventsFeed" class="pre">(鏃犳暟鎹?</pre>
        </div>
        <div id="tab-plan" class="tab hidden">
          <div class="row">
            <select id="mdKindSelect" class="select">
              <option value="plan" data-i18n="md.kind_plan">璁″垝</option>
              <option value="convention" data-i18n="md.kind_convention">绾﹀畾</option>
              <option value="path" data-i18n="md.kind_path">鏂囦欢</option>
            </select>
            <input
              id="mdPathInput"
              class="input hidden"
              placeholder="鐩稿宸ヤ綔鍖烘牴鐩綍锛屼緥濡?docs/plan.md"
              data-i18n-placeholder="md.path_placeholder"
            />
            <button id="loadMdBtn" class="btn btn--ghost" data-i18n="md.load">鍔犺浇</button>
          </div>
          <div id="mdInfo" class="hint mono">(鏈姞杞?</div>
          <pre id="planText" class="pre">(鏈姞杞?</pre>
        </div>
        <div id="tab-digest" class="tab hidden">
          <pre id="digestText" class="pre">(鏈姞杞?</pre>
        </div>
      </section>

      <section id="page-history" class="page card hidden">
        <h2 data-i18n="history.title">鍘嗗彶</h2>
        <div class="row">
          <button id="historyToggleListBtn" class="btn btn--ghost" data-i18n="history.toggle_list_hide">鏀惰捣鍒楄〃</button>
          <button id="refreshHistoryBtn" class="btn btn--ghost" data-i18n="common.refresh">鍒锋柊</button>
          <input id="historyFilter" class="input" placeholder="鎸?id/鐘舵€佽繃婊も€? data-i18n-placeholder="history.filter_placeholder" />
        </div>
        <div id="historyGrid" class="grid2">
          <div id="historyListPanel">
            <div id="historyList" class="list">(鏃犺繍琛?</div>
          </div>
          <div>
            <div class="row">
              <button id="historyToDashboardBtn" class="btn btn--ghost" data-i18n="history.open_in_dashboard">鍦ㄦ帶鍒跺彴鎵撳紑</button>
              <button id="historyExportMdBtn" class="btn btn--ghost" data-i18n="dash.export_md">瀵煎嚭 .md</button>
              <button id="historyExportJsonBtn" class="btn btn--ghost" data-i18n="dash.export_json">瀵煎嚭 .json</button>
              <label class="check" data-i18n-title="md.render_title">
                <input id="historyRenderMdToggle" type="checkbox" />
                <span data-i18n="md.render">MD 娓叉煋</span>
              </label>
            </div>
            <div class="row">
              <input
                id="historyTurnSearch"
                class="input"
                placeholder="鍦ㄥ洖鍚堝唴瀹归噷鎼滅储锛坧rompt/output/commands锛夆€?
                data-i18n-placeholder="history.turn_search_placeholder"
              />
            </div>
            <div id="historyDetail" class="list">(璇烽€夋嫨涓€涓繍琛?</div>
          </div>
        </div>
      </section>

      <section id="page-sessions" class="page card hidden">
        <h2 data-i18n="sessions.title">浼氳瘽</h2>
        <div class="row">
          <button id="refreshSessionsBtn" class="btn btn--ghost" data-i18n="common.refresh">鍒锋柊</button>
        </div>
        <div id="sessionsList" class="list">(鏃犱細璇?</div>
        <hr class="sep" />
        <h3 data-i18n="sessions.create_title">鍒涘缓浼氳瘽</h3>
        <div class="row">
          <select id="newSessionProvider" class="select" title="鎻愪緵鏂? data-i18n-title="sessions.new_provider_title">
            <option value="codex">codex</option>
            <option value="claude">claude</option>
            <option value="fake">fake</option>
          </select>
          <select id="newSessionRole" class="select">
            <option value="manager" data-i18n="role.manager_opt">涓荤锛坢anager锛?/option>
            <option value="executor" data-i18n="role.executor_opt">鎵ц鑰咃紙executor锛?/option>
          </select>
          <select id="newSessionSandbox" class="select">
            <option value="read-only" data-i18n="sandbox.read_only">鍙锛坮ead-only锛?/option>
            <option value="workspace-write" data-i18n="sandbox.workspace_write">鍙啓锛坵orkspace-write锛?/option>
            <option value="danger-full-access" data-i18n="sandbox.danger_full_access">瀹屽叏璁块棶锛坉anger-full-access锛?/option>
          </select>
          <select id="newSessionMode" class="select" title="浼氳瘽妯″紡" data-i18n-title="sessions.new_mode_title">
            <option value="" data-i18n="sessions.mode_default">mode锛堥粯璁わ細stateful_resume锛?/option>
            <option value="stateless_exec" data-i18n="sessions.mode_stateless">stateless_exec锛堜竴娆℃€э級</option>
            <option value="stateful_resume" data-i18n="sessions.mode_resume">stateful_resume锛堢画鑱婏級</option>
          </select>
          <input
            id="newSessionPromptPath"
            class="input"
            placeholder="systemPromptPath锛堜緥濡?prompts/manager_system.md锛?
            data-i18n-placeholder="sessions.new_system_prompt_path_placeholder"
          />
          <select id="newSessionModelPreset" class="select input--sm" data-i18n-title="model.preset_title">
            <option value="" data-i18n="model.preset_placeholder">model锛堥璁撅級</option>
          </select>
          <input
            id="newSessionModel"
            class="input input--sm"
            placeholder="model锛堝彲閫夛級"
            data-i18n-placeholder="sessions.new_model_placeholder"
            list="modelOptionsCodex"
          />
          <select id="newSessionEffort" class="select" title="reasoning effort" data-i18n-title="sessions.new_effort_title">
            <option value="" data-i18n="sessions.effort_default">effort锛堥粯璁わ級</option>
            <option value="low">low</option>
            <option value="medium">medium</option>
            <option value="high">high</option>
            <option value="xhigh">xhigh</option>
          </select>
          <select id="newSessionOutputFormat" class="select" title="claude 杈撳嚭鏍煎紡" data-i18n-title="sessions.new_output_format_title">
            <option value="" data-i18n="sessions.output_format_default">outputFormat锛堥粯璁わ級</option>
            <option value="text">text</option>
            <option value="json">json</option>
            <option value="stream-json">stream-json</option>
          </select>
          <select id="newSessionPermissionMode" class="select" title="claude 鏉冮檺妯″紡" data-i18n-title="sessions.new_permission_mode_title">
            <option value="" data-i18n="sessions.permission_mode_default">permissionMode锛堥粯璁わ級</option>
            <option value="default">default</option>
            <option value="dontAsk">dontAsk</option>
            <option value="acceptEdits">acceptEdits</option>
            <option value="plan">plan</option>
            <option value="bypassPermissions">bypassPermissions</option>
          </select>
          <label class="check" title="claude锛氱敤 --tools '' 绂佺敤宸ュ叿" data-i18n-title="sessions.new_tools_disabled_title">
            <input id="newSessionToolsDisabled" type="checkbox" />
            <span data-i18n="sessions.tools_off">绂佺敤宸ュ叿</span>
          </label>
          <input
            id="newSessionTools"
            class="input input--sm"
            placeholder="tools锛堝彲閫夛紝渚嬪 default, Read,Edit锛?
            data-i18n-placeholder="sessions.new_tools_placeholder"
          />
          <label class="check" title="claude锛氫粎 stream-json 鏈夋晥" data-i18n-title="sessions.new_include_partial_title">
            <input id="newSessionIncludePartial" type="checkbox" checked />
            <span data-i18n="sessions.include_partial">鍖呭惈 partial</span>
          </label>
          <label class="check" title="claude锛氬皢 session 钀界洏" data-i18n-title="sessions.new_session_persistence_title">
            <input id="newSessionSessionPersistence" type="checkbox" />
            <span data-i18n="sessions.session_persistence">浼氳瘽鎸佷箙鍖?/span>
          </label>
          <button id="createSessionBtn" class="btn" data-i18n="sessions.create_btn">鍒涘缓</button>
        </div>

        <hr class="sep" />
        <h3 data-i18n="sessions.edit_title">缂栬緫浼氳瘽</h3>
        <div class="row">
          <select id="editSessionSelect" class="select" title="浼氳瘽" data-i18n-title="sessions.edit_session_select_title"></select>
          <select id="editSessionProvider" class="select" title="鎻愪緵鏂? data-i18n-title="sessions.edit_provider_title">
            <option value="" data-i18n="sessions.edit_provider_keep">provider锛堜繚鎸佷笉鍙橈級</option>
            <option value="codex">codex</option>
            <option value="claude">claude</option>
            <option value="fake">fake</option>
          </select>
          <select id="editSessionSandbox" class="select" title="鏉冮檺" data-i18n-title="sessions.edit_sandbox_title">
            <option value="" data-i18n="sessions.edit_sandbox_keep">鏉冮檺锛堜繚鎸佷笉鍙橈級</option>
            <option value="read-only" data-i18n="sandbox.read_only">鍙锛坮ead-only锛?/option>
            <option value="workspace-write" data-i18n="sandbox.workspace_write">鍙啓锛坵orkspace-write锛?/option>
            <option value="danger-full-access" data-i18n="sandbox.danger_full_access">瀹屽叏璁块棶锛坉anger-full-access锛?/option>
          </select>
          <select id="editSessionMode" class="select" title="妯″紡" data-i18n-title="sessions.edit_mode_title">
            <option value="" data-i18n="sessions.edit_mode_keep">mode锛堜繚鎸佷笉鍙橈級</option>
            <option value="stateless_exec" data-i18n="sessions.mode_stateless">stateless_exec锛堜竴娆℃€э級</option>
            <option value="stateful_resume" data-i18n="sessions.mode_resume">stateful_resume锛堢画鑱婏級</option>
          </select>
          <select id="editSessionModelPreset" class="select input--sm" data-i18n-title="model.preset_title">
            <option value="" data-i18n="model.preset_placeholder">model锛堥璁撅級</option>
          </select>
          <input
            id="editSessionModel"
            class="input input--sm"
            placeholder="model锛堜繚鎸?鐣欑┖锛?
            data-i18n-placeholder="sessions.edit_model_placeholder"
            list="modelOptionsCodex"
          />
          <select id="editSessionEffort" class="select" title="reasoning effort" data-i18n-title="sessions.edit_effort_title">
            <option value="" data-i18n="sessions.effort_keep">effort锛堜繚鎸佷笉鍙橈級</option>
            <option value="low">low</option>
            <option value="medium">medium</option>
            <option value="high">high</option>
            <option value="xhigh">xhigh</option>
          </select>
          <button id="saveSessionBtn" class="btn" data-i18n="sessions.save">淇濆瓨</button>
          <button id="resetProviderSessionBtn" class="btn btn--ghost" data-i18n="sessions.reset_provider_session_id">
            閲嶇疆 providerSessionId
          </button>
          <button id="copySessionIdBtn" class="btn btn--ghost" data-i18n="sessions.copy_id">澶嶅埗 id</button>
        </div>
        <div class="hint" data-i18n="sessions.hint_reset">
          娉細Save/Reset 闇€瑕佸甫 ADMIN_TOKEN锛汻eset 浼氭竻绌?providerSessionId锛屼笅涓€娆¤繍琛屼細閲嶆柊鍒涘缓 thread/session銆?        </div>

        <hr class="sep" />
        <h3 data-i18n="sessions.rollovers_title">鎹㈣璁板綍</h3>
        <div class="row">
          <button id="refreshRolloversBtn" class="btn btn--ghost" data-i18n="common.refresh">鍒锋柊</button>
        </div>
        <div id="rolloversList" class="list">(鏃犳崲琛€璁板綍)</div>
      </section>

      <section id="page-settings" class="page card hidden">
        <h2 data-i18n="settings.title">璁剧疆</h2>
        <div class="row">
          <button id="refreshHealthBtn" class="btn btn--ghost" data-i18n="common.refresh">鍒锋柊</button>
        </div>
        <pre id="health" class="pre">(鍔犺浇涓€?</pre>
        <hr class="sep" />
        <h3 data-i18n="settings.capabilities_title">鑳藉姏鎺㈡祴</h3>
        <div class="row">
          <button id="refreshCapabilitiesBtn" class="btn btn--ghost" data-i18n="common.refresh">鍒锋柊</button>
          <button id="probeCapabilitiesBtn" class="btn" data-i18n="settings.probe">鎺㈡祴</button>
        </div>
        <pre id="capabilities" class="pre">(鏈帰娴?</pre>
        <div class="hint" data-i18n="settings.probe_hint">娉細Probe 浼氭墽琛屾湰鏈?CLI 鎺㈡祴鍛戒护锛岄渶瑕佸甫 ADMIN_TOKEN銆?/div>
        <hr class="sep" />
        <h3 data-i18n="settings.add_workspace_title">娣诲姞宸ヤ綔鍖?/h3>
        <div class="row">
          <input id="wsAddName" class="input" placeholder="鍚嶇О" data-i18n-placeholder="settings.ws_name_placeholder" />
          <input
            id="wsAddRoot"
            class="input"
            placeholder="rootPath锛堢粷瀵硅矾寰勶級"
            data-i18n-placeholder="settings.ws_root_placeholder"
          />
        </div>
        <div class="row">
          <input
            id="wsAddPlan"
            class="input"
            placeholder="planPath锛堝彲閫夛紝缁濆璺緞锛?
            data-i18n-placeholder="settings.ws_plan_placeholder"
          />
          <input
            id="wsAddConvention"
            class="input"
            placeholder="conventionPath锛堝彲閫夛紝缁濆璺緞锛?
            data-i18n-placeholder="settings.ws_convention_placeholder"
          />
          <button id="wsAddSubmit" class="btn" data-i18n="settings.add_workspace_btn">娣诲姞宸ヤ綔鍖?/button>
        </div>
        <div class="hint">
          <span data-i18n="settings.workspace_hint">娉細鍐欐帴鍙ｅ繀椤诲甫 ADMIN_TOKEN锛泈orkspace root 蹇呴』鍦?ALLOWED_WORKSPACE_ROOTS 鐧藉悕鍗曞唴銆?/span>
        </div>

        <hr class="sep" />
        <h3 data-i18n="settings.onboarding_title">鏂版墜寮曞</h3>
        <div class="row">
          <button id="resetOnboardingBtn" class="btn btn--ghost" data-i18n="settings.onboarding_reset">閲嶇疆鏂版墜寮曞</button>
        </div>
        <div class="hint" data-i18n="settings.onboarding_hint">娓呴櫎鈥滀笉鍐嶆彁绀衡€濓紝涓嬫鏃?workspace 鏃朵細閲嶆柊鏄剧ず寮曞銆?/div>
      </section>

      <section id="page-files" class="page card hidden">
        <div class="row">
          <h2 data-i18n="files.title">鏂囦欢</h2>
          <div class="hint" data-i18n="files.hint">
            鎻愮ず锛氭棤 ADMIN_TOKEN 鏃朵粎鍙彧璇绘祻瑙堥潪闅愯棌鏂囦欢锛涘～鍐?ADMIN_TOKEN 鍚庡彲娴忚闅愯棌鏂囦欢骞剁紪杈戜繚瀛樻枃鏈?Markdown銆?          </div>
        </div>

        <div class="filesGrid">
          <div>
            <div id="filesBreadcrumb" class="breadcrumb mono">/</div>
            <div class="row">
              <button id="filesUpBtn" class="btn btn--ghost" data-i18n="files.up">涓婁竴绾?/button>
              <input id="filesSearch" class="input" placeholder="鎼滅储..." data-i18n-placeholder="files.search_placeholder" />
              <button id="filesRefreshBtn" class="btn btn--ghost" data-i18n="common.refresh">鍒锋柊</button>
            </div>
            <div id="filesList" class="list">(鏃?</div>
            <div id="filesListMeta" class="hint mono"></div>
          </div>

          <div>
            <div class="row">
              <div id="filesSelectedPath" class="hint mono">(鏈€夋嫨鏂囦欢)</div>
              <div id="filesSelectedMeta" class="pill pill--muted">-</div>
            </div>
            <div id="filesPreviewHint" class="hint"></div>

            <div id="filesImagePanel" class="hidden">
              <img id="filesImage" class="filesImage" alt="" />
            </div>

            <div id="filesTextPanel" class="hidden">
              <div class="row">
                <button id="filesSaveBtn" class="btn btn--accent" data-i18n="files.save">淇濆瓨</button>
                <button id="filesReloadBtn" class="btn btn--ghost" data-i18n="files.reload">閲嶆柊鍔犺浇</button>
                <div id="filesEditStatus" class="hint mono"></div>
              </div>
              <textarea
                id="filesEditor"
                class="input input--textarea filesEditor"
                placeholder="(empty)"
                rows="14"
              ></textarea>
            </div>

            <div id="filesUnsupported" class="hint hidden" data-i18n="files.unsupported">(鏆備笉鏀寔棰勮)</div>
          </div>
        </div>
      </section>

      <section id="page-ask" class="page card hidden">
        <div class="row">
          <h2 data-i18n="ask.title">Codex 鐢ㄦ埛绐楀彛</h2>
          <div class="hint" data-i18n="ask.hint">娉細Codex 鐢ㄦ埛绐楀彛缁戝畾褰撳墠宸ヤ綔鍖猴紝骞朵娇鐢?resume 缁亰锛涘啓鎺ュ彛闇€瑕?ADMIN_TOKEN銆?/div>
          <button id="askToggleThreadsBtn" type="button" class="btn btn--ghost" data-i18n="ask.toggle_threads_hide">鏀惰捣瀵硅瘽</button>
          <button id="askToggleConfigBtn" type="button" class="btn btn--ghost" data-i18n="ask.toggle_config_hide">鏀惰捣閰嶇疆</button>
        </div>

        <div id="askGrid" class="askGrid">
          <div id="askThreadsPanel">
            <h3 data-i18n="ask.threads_title">瀵硅瘽</h3>
            <div class="row">
              <input id="askThreadSearch" class="input" placeholder="鎼滅储鈥? data-i18n-placeholder="ask.thread_search_placeholder" />
              <button id="askNewThreadBtn" class="btn" data-i18n="ask.new_thread">鏂板缓</button>
            </div>
            <div id="askThreadsList" class="list">(鏃犲璇?</div>
          </div>

          <div id="askChatPanel">
            <div class="row">
              <div id="askThreadHeader" class="hint mono">(鏈€夋嫨瀵硅瘽)</div>
              <div class="pill-group">
                <div id="askStatusPill" class="pill" data-i18n="ask.status_idle">灏辩华</div>
                <div id="askElapsed" class="pill pill--muted">鑰楁椂 鈥?/div>
                <div id="askUsage" class="pill pill--muted">鐢ㄩ噺 鈥?/div>
              </div>
              <button id="askExportMdBtn" class="btn btn--ghost" data-i18n="ask.export_md">瀵煎嚭 .md</button>
              <button id="askExportJsonlBtn" class="btn btn--ghost" data-i18n="ask.export_jsonl">瀵煎嚭 .jsonl</button>
              <label class="check" data-i18n-title="md.render_title">
                <input id="askRenderMdToggle" type="checkbox" />
                <span data-i18n="md.render">MD 娓叉煋</span>
              </label>
            </div>
            <div id="askMessages" class="chat">(鏆傛棤娑堟伅)</div>
            <details id="askQueuePanel" class="details">
              <summary>
                <span data-i18n="ask.queue_title">闃熷垪</span>
                <span id="askQueueCount" class="mono"></span>
              </summary>
              <div id="askQueue" class="queue">(鏃?</div>
            </details>
            <div class="row">
              <textarea
                id="askInput"
                class="input input--textarea"
                placeholder="杈撳叆浣犵殑闂鈥?
                data-i18n-placeholder="ask.input_placeholder"
                rows="4"
              ></textarea>
              <button id="askSendBtn" class="btn btn--accent" data-i18n="ask.send">鍙戦€?/button>
              <button id="askStopBtn" class="btn btn--danger" data-i18n="ask.stop">缁堟</button>
            </div>
            <div class="hint" data-i18n="ask.send_hint">蹇嵎閿細Ctrl+Enter 鍙戦€併€?/div>
          </div>

          <div id="askConfigPanel">
            <h3 data-i18n="ask.config_title">閰嶇疆</h3>
            <div class="kv kv--wrap kv--compact">
              <div class="kv__k">threadId</div>
              <div id="askThreadId" class="kv__v mono">-</div>
              <div class="kv__k">resumeId</div>
              <div id="askResumeId" class="kv__v mono">-</div>
              <div class="kv__k" data-i18n="ask.kv.provider">provider</div>
              <div id="askProvider" class="kv__v mono">-</div>
              <div class="kv__k" data-i18n="ask.kv.model">model</div>
              <div id="askModelView" class="kv__v mono">-</div>
              <div class="kv__k" data-i18n="ask.kv.effort">effort</div>
              <div id="askEffortView" class="kv__v mono">-</div>
              <div class="kv__k" data-i18n="ask.kv.sandbox">sandbox</div>
              <div id="askSandboxView" class="kv__v mono">-</div>
            </div>

            <div class="row">
              <input id="askTitleInput" class="input" placeholder="鏍囬" data-i18n-placeholder="ask.title_placeholder" />
              <button id="askSaveTitleBtn" class="btn btn--ghost" data-i18n="ask.save_title">淇濆瓨鏍囬</button>
            </div>

            <div class="row">
              <select id="askModelPreset" class="select input--sm" data-i18n-title="model.preset_title">
                <option value="" data-i18n="model.preset_placeholder">model锛堥璁撅級</option>
              </select>
              <input
                id="askModelInput"
                class="input"
                placeholder="model锛堝彲閫夛級"
                data-i18n-placeholder="ask.model_placeholder"
                list="modelOptionsCodex"
              />
              <select id="askEffortSelect" class="select" title="reasoning effort" data-i18n-title="ask.effort_title">
                <option value="" data-i18n="ask.effort_default">effort锛堥粯璁わ級</option>
                <option value="low">low</option>
                <option value="medium">medium</option>
                <option value="high">high</option>
                <option value="xhigh">xhigh</option>
              </select>
              <select id="askSandboxSelect" class="select">
                <option value="read-only">read-only</option>
                <option value="workspace-write">workspace-write</option>
                <option value="danger-full-access">danger-full-access</option>
              </select>
              <button id="askSaveConfigBtn" class="btn btn--ghost" data-i18n="ask.save_config">淇濆瓨閰嶇疆</button>
            </div>

            <div class="row">
              <button id="askResetResumeBtn" class="btn btn--ghost" data-i18n="ask.reset_resume">閲嶇疆缁亰</button>
              <button id="askDeleteThreadBtn" class="btn btn--danger" data-i18n="ask.delete_thread">鍒犻櫎</button>
            </div>

            <details class="details">
              <summary data-i18n="ask.debug">璋冭瘯</summary>
              <pre id="askDebug" class="pre mono">(鏃?</pre>
            </details>
          </div>
        </div>
      </section>
    </main>

    <div id="workspaceModal" class="modal hidden" aria-hidden="true">
      <div class="modal__panel" role="dialog" aria-modal="true" aria-labelledby="workspaceModalTitle">
        <div class="modal__header">
          <div id="workspaceModalTitle" class="modal__title" data-i18n="workspace_modal.title">鏂板缓宸ヤ綔鍖?/div>
          <button id="workspaceModalCloseBtn" class="btn btn--ghost" data-i18n="common.close">鍏抽棴</button>
        </div>
        <div id="workspaceModalError" class="modal__error hidden"></div>
        <label class="field">
          <span data-i18n="workspace_modal.name_label">鍚嶇О锛堝彲閫夛級</span>
          <input
            id="workspaceModalName"
            class="input"
            placeholder="鍚嶇О锛堝彲閫夛級"
            data-i18n-placeholder="workspace_modal.name_placeholder"
          />
        </label>
        <label class="field">
          <span data-i18n="workspace_modal.root_label">rootPath锛堝繀濉級</span>
          <input
            id="workspaceModalRoot"
            class="input"
            placeholder="rootPath锛堢粷瀵硅矾寰勶級"
            data-i18n-placeholder="workspace_modal.root_placeholder"
          />
        </label>
        <div class="row">
          <label class="field">
            <span data-i18n="workspace_modal.plan_label">planPath锛堥粯璁?plan.md锛?/span>
            <input
              id="workspaceModalPlan"
              class="input"
              placeholder="plan.md"
              data-i18n-placeholder="workspace_modal.plan_placeholder"
            />
          </label>
          <label class="field">
            <span data-i18n="workspace_modal.convention_label">conventionPath锛堥粯璁?绾﹀畾.md锛?/span>
            <input
              id="workspaceModalConvention"
              class="input"
              placeholder="绾﹀畾.md"
              data-i18n-placeholder="workspace_modal.convention_placeholder"
            />
          </label>
        </div>
        <div class="hint" data-i18n="workspace_modal.allowed_title">鍏佽鐨?rootPath锛堟潵鑷?/api/health锛?/div>
        <pre id="workspaceModalAllowedRoots" class="pre mono">(鍔犺浇涓€?</pre>
        <div id="workspaceModalAllowedError" class="modal__error hidden"></div>
        <div class="hint" data-i18n="workspace_modal.allowed_hint">rootPath 蹇呴』浣嶄簬鍏佽鍒楄〃鍐咃紝鍚﹀垯浼?PATH_NOT_ALLOWED銆?/div>
        <div class="row modal__actions">
          <button id="workspaceModalCancelBtn" class="btn btn--ghost" data-i18n="common.cancel">鍙栨秷</button>
          <button id="workspaceModalCreateBtn" class="btn" data-i18n="workspace_modal.create">鍒涘缓</button>
        </div>
      </div>
    </div>

    <div id="workspaceDocModal" class="modal hidden" aria-hidden="true">
      <div class="modal__panel" role="dialog" aria-modal="true" aria-labelledby="workspaceDocModalTitle">
        <div class="modal__header">
          <div id="workspaceDocModalTitle" class="modal__title" data-i18n="doc_modal.title_plan">鍔犺浇璁″垝</div>
          <button id="workspaceDocModalCloseBtn" class="btn btn--ghost" data-i18n="common.close">鍏抽棴</button>
        </div>
        <div class="row">
          <label class="check" data-i18n-title="md.render_title">
            <input id="workspaceDocRenderToggle" type="checkbox" />
            <span data-i18n="md.render">MD 娓叉煋</span>
          </label>
          <div id="workspaceDocModalInfo" class="hint mono">(鏈姞杞?</div>
        </div>
        <div id="workspaceDocModalError" class="modal__error hidden"></div>
        <div id="workspaceDocModalBody" class="pre">(鏈姞杞?</div>
      </div>
    </div>

    <datalist id="modelOptionsCodex">
      <option value="gpt-5.1"></option>
      <option value="gpt-5.1-codex"></option>
      <option value="gpt-5.2"></option>
      <option value="gpt-5.2-codex"></option>
    </datalist>
    <datalist id="modelOptionsClaude">
      <option value="sonnet"></option>
      <option value="opus"></option>
      <option value="claude-sonnet-4-5-20250929"></option>
    </datalist>

    <script src="/app.js"></script>
  </body>
</html>

